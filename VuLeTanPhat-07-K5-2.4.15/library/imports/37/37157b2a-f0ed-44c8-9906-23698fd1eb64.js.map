{"version":3,"sources":["assets/Day6/Bai7_D6.js"],"names":["callbackManager","funcArray","currentFuncs","retryCount","run","console","log","index","newFuncs","hasError","execute","length","setTimeout","func","originalIndex","cb","err","message","push","e","wrappedFuncs","map","f","i","asyncFunc1","callback","asyncFunc2","failOnce","asyncFunc4","Error","asyncFunc3"],"mappings":";;;;;;AAAA;AACA,SAASA,eAAT,CAAyBC,SAAzB,EAAoC;EAClC,IAAIC,YAAY,aAAOD,SAAP,CAAhB,CADkC,CACC;;EACnC,IAAIE,UAAU,GAAG,CAAjB,CAFkC,CAEC;EAEnC;;EACA,SAASC,GAAT,GAAe;IACb;IACAC,OAAO,CAACC,GAAR,CAAYH,UAAU,KAAK,CAAf,GAAmB,oCAAnB,0EAAuFA,UAAvF,UAAZ;IAEA,IAAII,KAAK,GAAG,CAAZ,CAJa,CAIa;;IAC1B,IAAIC,QAAQ,GAAG,EAAf,CALa,CAKa;;IAC1B,IAAIC,QAAQ,GAAG,KAAf,CANa,CAMa;IAE1B;;IACA,SAASC,OAAT,GAAmB;MACjB;MACA,IAAIH,KAAK,IAAIL,YAAY,CAACS,MAA1B,EAAkC;QAChC,IAAIF,QAAJ,EAAc;UACZ;UACAJ,OAAO,CAACC,GAAR,CAAY,oDAAZ;UACAJ,YAAY,GAAGM,QAAf,CAHY,CAGa;;UACzBL,UAAU,GAJE,CAIa;;UACzBS,UAAU,CAACR,GAAD,EAAM,IAAN,CAAV,CALY,CAKa;QAC1B,CAND,MAMO;UACL;UACAC,OAAO,CAACC,GAAR,CAAY,sCAAZ;QACD;;QACD;MACD,CAdgB,CAgBjB;;;MACA,IAAMO,IAAI,GAAGX,YAAY,CAACK,KAAD,CAAzB,CAjBiB,CAmBjB;;MACAF,OAAO,CAACC,GAAR,wBAAgCO,IAAI,CAACC,aAAL,GAAqB,CAArD;;MAEA,IAAI;QACF;QACAD,IAAI,CAACE,EAAL,CAAQ,UAACC,GAAD,EAAS;UACf,IAAIA,GAAJ,EAAS;YACP;YACAX,OAAO,CAACC,GAAR,oBAAqBO,IAAI,CAACC,aAA1B,2BAAmDE,GAAG,CAACC,OAAvD;YACAR,QAAQ,GAAG,IAAX,CAHO,CAGU;YACjB;UACD,CALD,MAKO;YACL;YACAJ,OAAO,CAACC,GAAR,0BAAkCO,IAAI,CAACC,aAAL,GAAqB,CAAvD;YACAT,OAAO,CAACC,GAAR,oBAAqBO,IAAI,CAACC,aAA1B;YACAN,QAAQ,CAACU,IAAT,CAAcL,IAAd,EAJK,CAIgB;UACtB;;UACDN,KAAK,GAZU,CAYD;;UACdG,OAAO,GAbQ,CAaD;QACf,CAdD;MAeD,CAjBD,CAiBE,OAAOS,CAAP,EAAU;QACV;QACAd,OAAO,CAACC,GAAR,uCAAmCO,IAAI,CAACC,aAAxC,UAA0DK,CAAC,CAACF,OAA5D;QACAR,QAAQ,GAAG,IAAX;QACAF,KAAK;QACLG,OAAO,GALG,CAKC;MACZ;IACF,CAvDY,CAyDb;;;IACAA,OAAO;EACR,CAhEiC,CAkElC;;;EACA,IAAMU,YAAY,GAAGnB,SAAS,CAACoB,GAAV,CAAc,UAACC,CAAD,EAAIC,CAAJ;IAAA,OAAW;MAAER,EAAE,EAAEO,CAAN;MAASR,aAAa,EAAES;IAAxB,CAAX;EAAA,CAAd,CAArB;EACArB,YAAY,GAAGkB,YAAf,CApEkC,CAoEL;;EAC7BhB,GAAG,GArE+B,CAqE3B;AACR;;AAED,SAASoB,UAAT,CAAoBC,QAApB,EAA8B;EAC5BpB,OAAO,CAACC,GAAR,CAAY,oBAAZ;EACAM,UAAU,CAAC,YAAM;IACfP,OAAO,CAACC,GAAR,CAAY,sBAAZ;IACAmB,QAAQ;EACT,CAHS,EAGP,IAHO,CAAV;AAID;;AAED,SAASC,UAAT,CAAoBD,QAApB,EAA8B;EAC5BpB,OAAO,CAACC,GAAR,CAAY,oBAAZ;EACAM,UAAU,CAAC,YAAM;IACfP,OAAO,CAACC,GAAR,CAAY,sBAAZ;IACAmB,QAAQ;EACT,CAHS,EAGP,IAHO,CAAV;AAID;;AAED,IAAIE,QAAQ,GAAG,IAAf;;AACA,SAASC,UAAT,CAAoBH,QAApB,EAA8B;EAC5BpB,OAAO,CAACC,GAAR,CAAY,oBAAZ;EACAM,UAAU,CAAC,YAAM;IACf,IAAIe,QAAJ,EAAc;MACZA,QAAQ,GAAG,KAAX;MACAF,QAAQ,CAAC,IAAII,KAAJ,CAAU,qBAAV,CAAD,CAAR;IACD,CAHD,MAGO;MACLxB,OAAO,CAACC,GAAR,CAAY,sBAAZ;MACAmB,QAAQ;IACT;EACF,CARS,EAQR,IARQ,CAAV;AASD;;AAGD,SAASK,UAAT,CAAoBL,QAApB,EAA8B;EAC5BpB,OAAO,CAACC,GAAR,CAAY,oBAAZ;EACAM,UAAU,CAAC,YAAM;IACfP,OAAO,CAACC,GAAR,CAAY,sBAAZ;IACAmB,QAAQ;EACT,CAHS,EAGP,IAHO,CAAV;AAID,EAED;AACA;;;AACAzB,eAAe,CAAC,CAACwB,UAAD,EAAaE,UAAb,EAAyBE,UAAzB,EAAqCE,UAArC,CAAD,CAAf,EAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AASA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAEA","sourceRoot":"/","sourcesContent":["// HÃ m chÃ­nh: nháº­n vÃ o 1 máº£ng cÃ¡c hÃ m async callback-style\nfunction callbackManager(funcArray) {\n  let currentFuncs = [...funcArray]; // Clone máº£ng Ä‘á»ƒ xá»­ lÃ½, trÃ¡nh lÃ m há»ng máº£ng gá»‘c\n  let retryCount = 0;                // Äáº¿m sá»‘ láº§n cháº¡y láº¡i (Ä‘á»ƒ biáº¿t lÃ  láº§n máº¥y)\n\n  // HÃ m phá»¥ Ä‘á»ƒ cháº¡y loáº¡t hÃ m hiá»‡n táº¡i\n  function run() {\n    // In thÃ´ng bÃ¡o cháº¡y láº§n Ä‘áº§u hay cháº¡y láº¡i\n    console.log(retryCount === 0 ? \"\\nðŸ” Báº¯t Ä‘áº§u cháº¡y hÃ m láº§n Ä‘áº§u...\\n\" : `\\nðŸ” Báº¯t Ä‘áº§u cháº¡y láº¡i láº§n ${retryCount}...\\n`);\n    \n    let index = 0;            // Biáº¿n Ä‘áº¿m vá»‹ trÃ­ hÃ m Ä‘ang cháº¡y\n    let newFuncs = [];        // Máº£ng má»›i chá»©a cÃ¡c hÃ m thÃ nh cÃ´ng Ä‘á»ƒ cháº¡y láº¡i náº¿u cáº§n\n    let hasError = false;     // Cá» bÃ¡o náº¿u cÃ³ lá»—i xáº£y ra\n\n    // HÃ m Ä‘á»‡ quy cháº¡y tá»«ng hÃ m má»™t theo thá»© tá»±\n    function execute() {\n      // Khi Ä‘Ã£ cháº¡y háº¿t cÃ¡c hÃ m\n      if (index >= currentFuncs.length) {\n        if (hasError) {\n          // Náº¿u cÃ³ lá»—i: thÃ´ng bÃ¡o vÃ  chuáº©n bá»‹ cháº¡y láº¡i sau 5s\n          console.log(\"\\nâŒ CÃ³ hÃ m bá»‹ lá»—i, sáº½ cháº¡y láº¡i toÃ n bá»™ sau 5s...\\n\");\n          currentFuncs = newFuncs; // Chá»‰ giá»¯ láº¡i hÃ m thÃ nh cÃ´ng Ä‘á»ƒ cháº¡y láº¡i\n          retryCount++;            // TÄƒng sá»‘ láº§n cháº¡y láº¡i\n          setTimeout(run, 5000);   // Chá» 5s rá»“i cháº¡y láº¡i\n        } else {\n          // Náº¿u táº¥t cáº£ Ä‘á»u thÃ nh cÃ´ng thÃ¬ káº¿t thÃºc\n          console.log(\"\\nâœ… Táº¥t cáº£ hÃ m Ä‘Ã£ cháº¡y thÃ nh cÃ´ng!\\n\");\n        }\n        return;\n      }\n\n      // Láº¥y hÃ m hiá»‡n táº¡i theo index\n      const func = currentFuncs[index];\n\n      // In tráº¡ng thÃ¡i báº¯t Ä‘áº§u cháº¡y hÃ m\n      console.log(`Started asyncFunc${func.originalIndex + 1}`);\n\n      try {\n        // Gá»i hÃ m async vá»›i callback nháº­n lá»—i (err)\n        func.cb((err) => {\n          if (err) {\n            // Náº¿u lá»—i: thÃ´ng bÃ¡o lá»—i\n            console.log(`âŒ HÃ m ${func.originalIndex} bá»‹ lá»—i: ${err.message}`);\n            hasError = true; // Cáº¯m cá» lá»—i\n            // KhÃ´ng push vÃ o newFuncs â†’ bá» luÃ´n khá»i láº§n cháº¡y sau\n          } else {\n            // Náº¿u thÃ nh cÃ´ng: in log vÃ  Ä‘Æ°a vÃ o danh sÃ¡ch cháº¡y tiáº¿p\n            console.log(`Completed asyncFunc${func.originalIndex + 1}`);\n            console.log(`âœ… HÃ m ${func.originalIndex} cháº¡y thÃ nh cÃ´ng!`);\n            newFuncs.push(func); // Chá»‰ giá»¯ hÃ m Ä‘Ã£ thÃ nh cÃ´ng\n          }\n          index++;      // TÄƒng chá»‰ sá»‘ Ä‘á»ƒ xá»­ lÃ½ tiáº¿p\n          execute();    // Gá»i Ä‘á»‡ quy cho hÃ m tiáº¿p theo\n        });\n      } catch (e) {\n        // Náº¿u cÃ³ lá»—i throw ngoÃ i callback (hiáº¿m): báº¯t ngoáº¡i lá»‡\n        console.log(`âŒ Exception táº¡i hÃ m ${func.originalIndex}: ${e.message}`);\n        hasError = true;\n        index++;\n        execute(); // Tiáº¿p tá»¥c xá»­ lÃ½ hÃ m sau\n      }\n    }\n\n    // Báº¯t Ä‘áº§u chuá»—i gá»i Ä‘á»‡ quy\n    execute();\n  }\n\n  // Gáº¯n thÃ´ng tin chá»‰ sá»‘ ban Ä‘áº§u vÃ o tá»«ng hÃ m Ä‘á»ƒ in log chÃ­nh xÃ¡c\n  const wrappedFuncs = funcArray.map((f, i) => ({ cb: f, originalIndex: i }));\n  currentFuncs = wrappedFuncs; // Cáº­p nháº­t máº£ng Ä‘ang cháº¡y\n  run(); // Báº¯t Ä‘áº§u thá»±c thi chuá»—i\n}\n\nfunction asyncFunc1(callback) {\n  console.log(\"Started asyncFunc1\");\n  setTimeout(() => {\n    console.log(\"Completed asyncFunc1\");\n    callback();\n  }, 3000);\n}\n\nfunction asyncFunc2(callback) {\n  console.log(\"Started asyncFunc2\");\n  setTimeout(() => {\n    console.log(\"Completed asyncFunc2\");\n    callback();\n  }, 2000);\n}\n\nlet failOnce = true;\nfunction asyncFunc4(callback) {\n  console.log(\"Started asyncFunc4\");\n  setTimeout(() => {\n    if( failOnce) {\n      failOnce = false;\n      callback(new Error(\"Error in asyncFunc4\"));\n    } else {\n      console.log(\"Completed asyncFunc4\");\n      callback();\n    }\n  },1000);\n}\n\n\nfunction asyncFunc3(callback) {\n  console.log(\"Started asyncFunc3\");\n  setTimeout(() => {\n    console.log(\"Completed asyncFunc3\");\n    callback();\n  }, 1000);\n}\n\n// Driver code\n// lan chay dau tien\ncallbackManager([asyncFunc1, asyncFunc2, asyncFunc4, asyncFunc3]);\n\n// sau khi chay nhan xet:\n// ke tu khi lenh Started asyncFunc1 thi mat 3s de hien completed tuong tu asyncFunc2 mat 2s va cuoi cung mat 1s, moi thu in ra theo dung thu tu voi dung so giay.\n\n// lan chay thu 2 (sau 7s)\n\n// setTimeout(() =>{\n//   console.log(\"_________________________\")\n//   console.log(\"CALLING AGAINNNNNNN\")\n//   callbackManager([asyncFunc1, asyncFunc2, asyncFunc4, asyncFunc3]);\n// },7000)\n\n\n\n\n\n\n\n\n//bonus ASCI tu chatGPT de hieu Flow\n\n// funcArray = [asyncFunc1, asyncFunc2, asyncFunc3]\n\n// Gá»i callbackManager([asyncFunc1, asyncFunc2, asyncFunc3])\n// â†“\n// Gá»i execute(0)\n// â†“\n// Gá»i asyncFunc1(callback: () => execute(1))\n//    â†“\n//    Äá»£i 3 giÃ¢y...\n//    â†“\n//    Gá»i callback â†’ execute(1)\n//    â†“\n//    Gá»i asyncFunc2(callback: () => execute(2))\n//        â†“\n//        Äá»£i 2 giÃ¢y...\n//        â†“\n//        Gá»i callback â†’ execute(2)\n//        â†“\n//        Gá»i asyncFunc3(callback: () => execute(3))\n//            â†“\n//            Äá»£i 1 giÃ¢y...\n//            â†“\n//            Gá»i callback â†’ execute(3)\n//                â†“\n//                ThoÃ¡t vÃ¬ index >= funcArray.length\n\n\n// async4 throw new error, chen vao giua, khi ham loi go ra va chay lai cho du\n\n// lan sau goi lai se chay het duoc"]}