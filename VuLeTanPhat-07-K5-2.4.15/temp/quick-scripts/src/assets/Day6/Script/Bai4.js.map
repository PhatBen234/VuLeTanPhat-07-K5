{"version":3,"sources":["assets/Day6/Script/Bai4.js"],"names":["cc","Class","Component","properties","logLabel","Label","start","Store","name","dependencies","wait","store","push","resolve","stepTime","visited","results","logFunc","Set","has","add","dep","Promise","setTimeout","log","contribute","stores","finalLog","join","logToLabel","msg","string","store1","store2","store3","store4","store5"],"mappings":"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","sourceRoot":"/","sourcesContent":["//ma oi bai nay khong hieu gi het\n\ncc.Class({\n  extends: cc.Component,\n\n  properties: {\n    logLabel: cc.Label, // Gán node Label từ Inspector để in kết quả log\n  },\n\n  start() {\n    // ─── CLASS STORE ─────────────────────\n    // Mỗi Store là một \"công đoạn\" có thể phụ thuộc vào công đoạn khác\n    class Store {\n      constructor(name) {\n        this.name = name; // Tên của Store\n        this.dependencies = []; // Danh sách các Store mà Store này phụ thuộc\n      }\n\n      // Thêm một store phụ thuộc vào danh sách\n      wait(store) {\n        this.dependencies.push(store);\n      }\n\n      // Giải quyết store theo thứ tự phụ thuộc (đệ quy)\n      async resolve(stepTime, visited = new Set(), results = [], logFunc) {\n        if (visited.has(this)) return; // Nếu đã xử lý rồi thì bỏ qua (tránh lặp vô hạn)\n\n        visited.add(this); // Đánh dấu là đã xử lý\n\n        // Giải quyết các phụ thuộc trước\n        for (const dep of this.dependencies) {\n          await dep.resolve(stepTime, visited, results, logFunc);\n        }\n\n        // Đợi stepTime giây trước khi thực hiện store này\n        await new Promise(resolve => setTimeout(resolve, stepTime * 1000));\n\n        cc.log(this.name); // In tên store ra console\n        logFunc(this.name); // Ghi log vào Label UI\n        results.push(this.name); // Lưu tên store đã hoàn thành vào mảng kết quả\n      }\n    }\n\n    // ─── FUNCTION CONTRIBUTE ──────────────\n    // Hàm chính thực thi toàn bộ các store truyền vào theo đúng thứ tự phụ thuộc\n    async function contribute(stepTime, logFunc, ...stores) {\n      const visited = new Set(); // Đánh dấu store đã thực hiện\n      const results = []; // Lưu kết quả tên store theo thứ tự\n\n      for (const store of stores) {\n        await store.resolve(stepTime, visited, results, logFunc); // Giải quyết từng store\n      }\n\n      // Sau khi tất cả store xong, log kết quả cuối cùng\n      const finalLog = 'Hoàn tất: ' + results.join(' → ');\n      cc.log(finalLog);\n      logFunc(finalLog);\n    }\n\n    // ─── LOG HELPER ───────────────────────\n    // Ghi một dòng log vào Label UI\n    const logToLabel = (msg) => {\n      this.logLabel.string += msg + '\\n';\n    };\n\n    // ─── TẠO CÁC STORE & PHỤ THUỘC ───────\n    const store1 = new Store('store_1');\n    const store2 = new Store('store_2');\n    const store3 = new Store('store_3');\n    const store4 = new Store('store_4');\n    const store5 = new Store('store_5');\n\n    // Thiết lập quan hệ phụ thuộc:\n    // store1 -> store3 -> store2 -> store5 -> store4\n    store1.wait(store3);\n    store3.wait(store2);\n    store2.wait(store5);\n    store5.wait(store4);\n\n    // ─── THỰC THI CHÍNH ───────────────────\n    this.logLabel.string = ''; // Xóa nội dung label trước khi chạy\n    contribute(3, logToLabel, store1, store2, store3, store4, store5);\n    // Gọi contribute() với delay 3 giây giữa mỗi bước\n  }\n});\n"]}