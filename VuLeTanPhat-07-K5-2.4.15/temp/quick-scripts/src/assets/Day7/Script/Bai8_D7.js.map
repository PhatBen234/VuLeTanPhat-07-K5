{"version":3,"sources":["assets/Day7/Script/Bai8_D7.js"],"names":["cc","Class","Component","properties","timeLabel","Label","start","getLocalTime","Date","getTime","getServerTime","fetch","window","location","href","toString","method","headers","response","dateHeader","get","Error","error","now","promisify","fn","result","Promise","resolve","err","reject","localTime","serverTime","latency","log","string"],"mappings":";;;;;;+CACA;;;;;;AADAA,EAAE,CAACC,KAAH,CAAS;EACP,WAASD,EAAE,CAACE,SADL;EAGPC,UAAU,EAAE;IACVC,SAAS,EAAEJ,EAAE,CAACK;EADJ,CAHL;EAOPC,KAPO,mBAOC;IAAA;;IACN;IACA,SAASC,YAAT,GAAwB;MACtB,OAAO,IAAIC,IAAJ,GAAWC,OAAX,EAAP;IACD,CAJK,CAMN;;;IANM,SAOSC,aAPT;MAAA;IAAA,EAyBN;;;IAzBM;MAAA,4EAON;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAE2BC,KAAK,CAACC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBC,QAArB,EAAD,EAAkC;kBAC5DC,MAAM,EAAE,MADoD;kBAE5DC,OAAO,EAAE;oBACP,gBAAgB;kBADT;gBAFmD,CAAlC,CAFhC;;cAAA;gBAEUC,QAFV;gBASUC,UATV,GASuBD,QAAQ,CAACD,OAAT,CAAiBG,GAAjB,CAAqB,MAArB,CATvB;;gBAAA,IAUSD,UAVT;kBAAA;kBAAA;gBAAA;;gBAAA,MAU2B,IAAIE,KAAJ,CAAU,sBAAV,CAV3B;;cAAA;gBAAA,kCAWW,IAAIb,IAAJ,CAASW,UAAT,EAAqBV,OAArB,EAXX;;cAAA;gBAAA;gBAAA;gBAaIT,EAAE,CAACsB,KAAH,CAAS,oBAAT;gBAbJ,kCAcWd,IAAI,CAACe,GAAL,EAdX;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CAPM;MAAA;IAAA;;IA0BN,SAASC,SAAT,CAAmBC,EAAnB,EAAuB;MAAE;MACvB,OAAO,YAAmB;QAAE;QAC1B,IAAI;UACF,IAAMC,MAAM,GAAGD,EAAE,MAAF,mBAAf,CADE,CACwB;;UAC1B,OAAOC,MAAM,YAAYC,OAAlB,GAA4BD,MAA5B,GAAqCC,OAAO,CAACC,OAAR,CAAgBF,MAAhB,CAA5C,CAFE,CAEkE;QACrE,CAHD,CAGE,OAAOG,GAAP,EAAY;UACZ,OAAOF,OAAO,CAACG,MAAR,CAAeD,GAAf,CAAP,CADY,CACe;QAC5B;MACF,CAPD;IAQD,CAnCK,CAqCN;;;IACA,2DAAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACyBL,SAAS,CAACjB,YAAD,CAAT,EADzB;;YAAA;cACOwB,SADP;cAAA;cAAA,OAE0BP,SAAS,CAACd,aAAD,CAAT,EAF1B;;YAAA;cAEOsB,UAFP;cAEqD;cAC9CC,OAHP,GAGiBD,UAAU,GAAGD,SAH9B,EAGyC;;cAElCL,MALP,oBAK+BK,SAL/B,uBAK0DC,UAL1D,iCAKiFC,OALjF;cAMCjC,EAAE,CAACkC,GAAH,CAAOR,MAAP;cACA,KAAI,CAACtB,SAAL,CAAe+B,MAAf,GAAwBT,MAAxB;;YAPD;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAD;EASD;AAtDM,CAAT","sourceRoot":"/","sourcesContent":["cc.Class({\n  extends: cc.Component,\n\n  properties: {\n    timeLabel: cc.Label,\n  },\n\n  start() {\n    // Hàm thường\n    function getLocalTime() {\n      return new Date().getTime();\n    }\n\n    // Hàm async\n    async function getServerTime() {\n      try {\n        const response = await fetch(window.location.href.toString(), {\n          method: 'HEAD',\n          headers: {\n            'Content-Type': 'text/html'\n          }\n        });\n\n        const dateHeader = response.headers.get(\"Date\");\n        if (!dateHeader) throw new Error(\"Không có Date header\");\n        return new Date(dateHeader).getTime();\n      } catch (err) {\n        cc.error(\"Lỗi getServerTime:\", err);\n        return Date.now(); // fallback\n      }\n    }\n\n    // Hàm promisify\n    function promisify(fn) { // dinh nghia no la 1 promisify\n      return function (...args) { //tra ve ham moi, nhan tat ca doi so args truyen vao ham\n        try {\n          const result = fn(...args)// goi ham fn goc voi cac doi so;\n          return result instanceof Promise ? result : Promise.resolve(result);// ep no thanh promise, neu la promise thi thoi, con k ep no thanh promise\n        } catch (err) {\n          return Promise.reject(err);// tra ve promise reject\n        }\n      };\n    }\n\n    // Chạy thử\n    (async () => {// tao va goi ham async an danh, dung de await ben trong\n      const localTime = await promisify(getLocalTime)();// gan promisify\n      const serverTime = await promisify(getServerTime)();// gan promisify\n      const latency = serverTime - localTime; //tinh do tre\n\n      const result = `Local Time: ${localTime}\\nServer Time: ${serverTime}\\nĐộ trễ: ${latency}ms`;\n      cc.log(result);\n      this.timeLabel.string = result;\n    })();\n  }\n});\n"]}