{"version":3,"sources":["GameManager.js"],"names":["cc","Class","extends","Component","properties","playerHpLabel","Label","playerMpLabel","playerAtkLabel","playerDefLabel","enemyHpLabel","enemyMpLabel","enemyAtkLabel","enemyDefLabel","messageLabel","attackBtn","Button","skillBtn","recoverBtn","onLoad","player","health","energy","attack","randomInRange","defense","enemy","updateUI","node","on","onAttack","onSkill","onRecover","min","max","Math","floor","random","string","isGameOver","damage","checkGameOver","scheduleOnce","enemyTurn","disableButtons","interactable"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACPC,WAASF,GAAGG,SADL;;AAGPC,cAAY;AACV;AACAC,mBAAeL,GAAGM,KAFR;AAGVC,mBAAeP,GAAGM,KAHR;AAIVE,oBAAgBR,GAAGM,KAJT;AAKVG,oBAAgBT,GAAGM,KALT;;AAOV;AACAI,kBAAcV,GAAGM,KARP;AASVK,kBAAcX,GAAGM,KATP;AAUVM,mBAAeZ,GAAGM,KAVR;AAWVO,mBAAeb,GAAGM,KAXR;;AAaV;AACAQ,kBAAcd,GAAGM,KAdP;;AAgBV;AACAS,eAAWf,GAAGgB,MAjBJ;AAkBVC,cAAUjB,GAAGgB,MAlBH;AAmBVE,gBAAYlB,GAAGgB;AAnBL,GAHL;;AAyBPG,QAzBO,oBAyBE;AACP,SAAKC,MAAL,GAAc;AACZC,cAAQ,GADI;AAEZC,cAAQ,EAFI;AAGZC,cAAQ,KAAKC,aAAL,CAAmB,EAAnB,EAAuB,EAAvB,CAHI;AAIZC,eAAS,KAAKD,aAAL,CAAmB,CAAnB,EAAsB,EAAtB;AAJG,KAAd;AAMA,SAAKE,KAAL,GAAa;AACXL,cAAQ,GADG;AAEXC,cAAQ,EAFG;AAGXC,cAAQ,KAAKC,aAAL,CAAmB,EAAnB,EAAuB,EAAvB,CAHG;AAIXC,eAAS,KAAKD,aAAL,CAAmB,CAAnB,EAAsB,EAAtB;AAJE,KAAb;;AAOA,SAAKG,QAAL;;AAEA,SAAKZ,SAAL,CAAea,IAAf,CAAoBC,EAApB,CAAuB,OAAvB,EAAgC,KAAKC,QAArC,EAA+C,IAA/C;AACA,SAAKb,QAAL,CAAcW,IAAd,CAAmBC,EAAnB,CAAsB,OAAtB,EAA+B,KAAKE,OAApC,EAA6C,IAA7C;AACA,SAAKb,UAAL,CAAgBU,IAAhB,CAAqBC,EAArB,CAAwB,OAAxB,EAAiC,KAAKG,SAAtC,EAAiD,IAAjD;AACD,GA5CM;AA8CPR,eA9CO,yBA8COS,GA9CP,EA8CYC,GA9CZ,EA8CiB;AACtB,WAAOC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,MAAiBH,MAAMD,GAAN,GAAY,CAA7B,CAAX,IAA8CA,GAArD;AACD,GAhDM;AAkDPN,UAlDO,sBAkDI;AACT,SAAKtB,aAAL,CAAmBiC,MAAnB,YAAmCH,KAAKD,GAAL,CAAS,CAAT,EAAY,KAAKd,MAAL,CAAYC,MAAxB,CAAnC;AACA,SAAKd,aAAL,CAAmB+B,MAAnB,YAAmC,KAAKlB,MAAL,CAAYE,MAA/C;AACA,SAAKd,cAAL,CAAoB8B,MAApB,aAAqC,KAAKlB,MAAL,CAAYG,MAAjD;AACA,SAAKd,cAAL,CAAoB6B,MAApB,aAAqC,KAAKlB,MAAL,CAAYK,OAAjD;;AAEA,SAAKf,YAAL,CAAkB4B,MAAlB,YAAkCH,KAAKD,GAAL,CAAS,CAAT,EAAY,KAAKR,KAAL,CAAWL,MAAvB,CAAlC;AACA,SAAKV,YAAL,CAAkB2B,MAAlB,YAAkC,KAAKZ,KAAL,CAAWJ,MAA7C;AACA,SAAKV,aAAL,CAAmB0B,MAAnB,aAAoC,KAAKZ,KAAL,CAAWH,MAA/C;AACA,SAAKV,aAAL,CAAmByB,MAAnB,aAAoC,KAAKZ,KAAL,CAAWD,OAA/C;AACD,GA5DM;AA8DPK,UA9DO,sBA8DI;AACT,QAAI,KAAKS,UAAL,EAAJ,EAAuB;;AAEvB,QAAMC,SAASL,KAAKD,GAAL,CAAS,CAAT,EAAY,KAAKd,MAAL,CAAYG,MAAZ,GAAqB,KAAKG,KAAL,CAAWD,OAA5C,CAAf;AACA,SAAKC,KAAL,CAAWL,MAAX,IAAqBmB,MAArB;AACA,SAAKb,QAAL;;AAEA,SAAKc,aAAL;AACA,QAAI,CAAC,KAAKF,UAAL,EAAL,EAAwB,KAAKG,YAAL,CAAkB,KAAKC,SAAvB,EAAkC,CAAlC;AACzB,GAvEM;AAyEPZ,SAzEO,qBAyEG;AAAA;;AACR,QAAI,KAAKQ,UAAL,EAAJ,EAAuB;;AAEvB,QAAI,KAAKnB,MAAL,CAAYE,MAAZ,IAAsB,EAA1B,EAA8B;AAC5B,WAAKF,MAAL,CAAYE,MAAZ,IAAsB,EAAtB;AACA,UAAMkB,SAASL,KAAKD,GAAL,CAAS,CAAT,EAAY,KAAKd,MAAL,CAAYG,MAAZ,GAAqB,CAArB,GAAyB,KAAKG,KAAL,CAAWD,OAAhD,CAAf;AACA,WAAKC,KAAL,CAAWL,MAAX,IAAqBmB,MAArB;AACA,WAAKb,QAAL;;AAEA,WAAKc,aAAL;AACA,UAAI,CAAC,KAAKF,UAAL,EAAL,EAAwB,KAAKG,YAAL,CAAkB,KAAKC,SAAvB,EAAkC,CAAlC;AACzB,KARD,MAQO;AACL,WAAK7B,YAAL,CAAkBwB,MAAlB,GAA2B,sBAA3B;AACA,WAAKI,YAAL,CAAkB,YAAM;AACtB,cAAK5B,YAAL,CAAkBwB,MAAlB,GAA2B,EAA3B;AACD,OAFD,EAEG,CAFH;AAGD;AACF,GA1FM;AA4FPN,WA5FO,uBA4FK;AACV,QAAI,KAAKO,UAAL,EAAJ,EAAuB;;AAEvB,SAAKnB,MAAL,CAAYE,MAAZ,GAAqBa,KAAKF,GAAL,CAAS,GAAT,EAAc,KAAKb,MAAL,CAAYE,MAAZ,GAAqB,EAAnC,CAArB;AACA,SAAKK,QAAL;;AAEA,SAAKe,YAAL,CAAkB,KAAKC,SAAvB,EAAkC,CAAlC;AACD,GAnGM;AAqGPA,WArGO,uBAqGK;AACV,QAAI,KAAKJ,UAAL,EAAJ,EAAuB;;AAEvB,QAAMC,SAASL,KAAKD,GAAL,CAAS,CAAT,EAAY,KAAKR,KAAL,CAAWH,MAAX,GAAoB,KAAKH,MAAL,CAAYK,OAA5C,CAAf;AACA,SAAKL,MAAL,CAAYC,MAAZ,IAAsBmB,MAAtB;AACA,SAAKb,QAAL;AACA,SAAKc,aAAL;AACD,GA5GM;AA8GPA,eA9GO,2BA8GS;AACd,QAAI,KAAKrB,MAAL,CAAYC,MAAZ,IAAsB,CAA1B,EAA6B;AAC3B,WAAKP,YAAL,CAAkBwB,MAAlB,GAA2B,cAA3B;AACA,WAAKM,cAAL;AACD,KAHD,MAGO,IAAI,KAAKlB,KAAL,CAAWL,MAAX,IAAqB,CAAzB,EAA4B;AACjC,WAAKP,YAAL,CAAkBwB,MAAlB,GAA2B,aAA3B;AACA,WAAKM,cAAL;AACD;AACF,GAtHM;AAwHPL,YAxHO,wBAwHM;AACX,WAAO,KAAKnB,MAAL,CAAYC,MAAZ,IAAsB,CAAtB,IAA2B,KAAKK,KAAL,CAAWL,MAAX,IAAqB,CAAvD;AACD,GA1HM;AA4HPuB,gBA5HO,4BA4HU;AACf,SAAK7B,SAAL,CAAe8B,YAAf,GAA8B,KAA9B;AACA,SAAK5B,QAAL,CAAc4B,YAAd,GAA6B,KAA7B;AACA,SAAK3B,UAAL,CAAgB2B,YAAhB,GAA+B,KAA/B;AACD;AAhIM,CAAT","file":"GameManager.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Day2\\Bai1\\Data","sourcesContent":["cc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    // Player labels\r\n    playerHpLabel: cc.Label,\r\n    playerMpLabel: cc.Label,\r\n    playerAtkLabel: cc.Label,\r\n    playerDefLabel: cc.Label,\r\n\r\n    // Enemy labels\r\n    enemyHpLabel: cc.Label,\r\n    enemyMpLabel: cc.Label,\r\n    enemyAtkLabel: cc.Label,\r\n    enemyDefLabel: cc.Label,\r\n\r\n    // Message for Game Over or Not enough mana\r\n    messageLabel: cc.Label,\r\n\r\n    // Buttons\r\n    attackBtn: cc.Button,\r\n    skillBtn: cc.Button,\r\n    recoverBtn: cc.Button,\r\n  },\r\n\r\n  onLoad() {\r\n    this.player = {\r\n      health: 100,\r\n      energy: 50,\r\n      attack: this.randomInRange(10, 20),\r\n      defense: this.randomInRange(5, 15),\r\n    };\r\n    this.enemy = {\r\n      health: 100,\r\n      energy: 50,\r\n      attack: this.randomInRange(10, 20),\r\n      defense: this.randomInRange(5, 15),\r\n    };\r\n\r\n    this.updateUI();\r\n\r\n    this.attackBtn.node.on(\"click\", this.onAttack, this);\r\n    this.skillBtn.node.on(\"click\", this.onSkill, this);\r\n    this.recoverBtn.node.on(\"click\", this.onRecover, this);\r\n  },\r\n\r\n  randomInRange(min, max) {\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n  },\r\n\r\n  updateUI() {\r\n    this.playerHpLabel.string = `HP: ${Math.max(0, this.player.health)}`;\r\n    this.playerMpLabel.string = `MP: ${this.player.energy}`;\r\n    this.playerAtkLabel.string = `ATK: ${this.player.attack}`;\r\n    this.playerDefLabel.string = `DEF: ${this.player.defense}`;\r\n\r\n    this.enemyHpLabel.string = `HP: ${Math.max(0, this.enemy.health)}`;\r\n    this.enemyMpLabel.string = `MP: ${this.enemy.energy}`;\r\n    this.enemyAtkLabel.string = `ATK: ${this.enemy.attack}`;\r\n    this.enemyDefLabel.string = `DEF: ${this.enemy.defense}`;\r\n  },\r\n\r\n  onAttack() {\r\n    if (this.isGameOver()) return;\r\n\r\n    const damage = Math.max(0, this.player.attack - this.enemy.defense);\r\n    this.enemy.health -= damage;\r\n    this.updateUI();\r\n\r\n    this.checkGameOver();\r\n    if (!this.isGameOver()) this.scheduleOnce(this.enemyTurn, 1);\r\n  },\r\n\r\n  onSkill() {\r\n    if (this.isGameOver()) return;\r\n\r\n    if (this.player.energy >= 30) {\r\n      this.player.energy -= 30;\r\n      const damage = Math.max(0, this.player.attack * 2 - this.enemy.defense);\r\n      this.enemy.health -= damage;\r\n      this.updateUI();\r\n\r\n      this.checkGameOver();\r\n      if (!this.isGameOver()) this.scheduleOnce(this.enemyTurn, 1);\r\n    } else {\r\n      this.messageLabel.string = \"❌ Not enough energy!\";\r\n      this.scheduleOnce(() => {\r\n        this.messageLabel.string = \"\";\r\n      }, 2);\r\n    }\r\n  },\r\n\r\n  onRecover() {\r\n    if (this.isGameOver()) return;\r\n\r\n    this.player.energy = Math.min(100, this.player.energy + 20);\r\n    this.updateUI();\r\n\r\n    this.scheduleOnce(this.enemyTurn, 1);\r\n  },\r\n\r\n  enemyTurn() {\r\n    if (this.isGameOver()) return;\r\n\r\n    const damage = Math.max(0, this.enemy.attack - this.player.defense);\r\n    this.player.health -= damage;\r\n    this.updateUI();\r\n    this.checkGameOver();\r\n  },\r\n\r\n  checkGameOver() {\r\n    if (this.player.health <= 0) {\r\n      this.messageLabel.string = \"💀 You Lose!\";\r\n      this.disableButtons();\r\n    } else if (this.enemy.health <= 0) {\r\n      this.messageLabel.string = \"🏆 You Win!\";\r\n      this.disableButtons();\r\n    }\r\n  },\r\n\r\n  isGameOver() {\r\n    return this.player.health <= 0 || this.enemy.health <= 0;\r\n  },\r\n\r\n  disableButtons() {\r\n    this.attackBtn.interactable = false;\r\n    this.skillBtn.interactable = false;\r\n    this.recoverBtn.interactable = false;\r\n  },\r\n});\r\n"]}