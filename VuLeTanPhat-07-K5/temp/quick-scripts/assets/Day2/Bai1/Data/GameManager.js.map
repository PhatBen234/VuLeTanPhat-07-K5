{"version":3,"sources":["GameManager.js"],"names":["cc","Class","extends","Component","properties","playerHpLabel","Label","playerMpLabel","playerAtkLabel","playerDefLabel","enemyHpLabel","enemyMpLabel","enemyAtkLabel","enemyDefLabel","messageLabel","attackBtn","Button","skillBtn","recoverBtn","onLoad","initCharacters","updateUI","setupButtonEvents","player","health","energy","attack","randomInRange","defense","enemy","node","on","onAttack","onSkill","onRecover","min","max","Math","floor","random","string","isGameOver","damage","checkGameOver","scheduleOnce","enemyTurn","disableButtons","interactable"],"mappings":"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","file":"GameManager.js","sourceRoot":"../../../../../../assets/Day2/Bai1/Data","sourcesContent":["cc.Class({\n  extends: cc.Component,\n\n  properties: {\n    // Player labels\n    playerHpLabel: cc.Label,\n    playerMpLabel: cc.Label,\n    playerAtkLabel: cc.Label,\n    playerDefLabel: cc.Label,\n\n    // Enemy labels\n    enemyHpLabel: cc.Label,\n    enemyMpLabel: cc.Label,\n    enemyAtkLabel: cc.Label,\n    enemyDefLabel: cc.Label,\n\n    // Message display\n    messageLabel: cc.Label,\n\n    // Buttons\n    attackBtn: cc.Button,\n    skillBtn: cc.Button,\n    recoverBtn: cc.Button,\n  },\n\n  onLoad() {\n    this.initCharacters();\n    this.updateUI();\n    this.setupButtonEvents();\n  },\n\n  initCharacters() {\n    this.player = {\n      health: 100,\n      energy: 50,\n      attack: this.randomInRange(10, 20),\n      defense: this.randomInRange(5, 15),\n    };\n\n    this.enemy = {\n      health: 100,\n      energy: 50,\n      attack: this.randomInRange(10, 20),\n      defense: this.randomInRange(5, 15),\n    };\n  },\n\n  setupButtonEvents() {\n    this.attackBtn.node.on(\"click\", this.onAttack, this);\n    this.skillBtn.node.on(\"click\", this.onSkill, this);\n    this.recoverBtn.node.on(\"click\", this.onRecover, this);\n  },\n\n  randomInRange(min, max) {\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n  },\n\n  updateUI() {\n    this.playerHpLabel.string = `HP: ${Math.max(0, this.player.health)}`;\n    this.playerMpLabel.string = `MP: ${this.player.energy}`;\n    this.playerAtkLabel.string = `ATK: ${this.player.attack}`;\n    this.playerDefLabel.string = `DEF: ${this.player.defense}`;\n\n    this.enemyHpLabel.string = `HP: ${Math.max(0, this.enemy.health)}`;\n    this.enemyMpLabel.string = `MP: ${this.enemy.energy}`;\n    this.enemyAtkLabel.string = `ATK: ${this.enemy.attack}`;\n    this.enemyDefLabel.string = `DEF: ${this.enemy.defense}`;\n  },\n\n  onAttack() {\n    if (this.isGameOver()) return;\n\n    const damage = Math.max(0, this.player.attack - this.enemy.defense);\n    this.enemy.health -= damage;\n\n    this.updateUI();\n    this.checkGameOver();\n\n    if (!this.isGameOver()) this.scheduleOnce(this.enemyTurn, 1);\n  },\n\n  onSkill() {\n    if (this.isGameOver()) return;\n\n    if (this.player.energy >= 30) {\n      this.player.energy -= 30;\n      const damage = Math.max(0, this.player.attack * 2 - this.enemy.defense);\n      this.enemy.health -= damage;\n\n      this.updateUI();\n      this.checkGameOver();\n\n      if (!this.isGameOver()) this.scheduleOnce(this.enemyTurn, 1);\n    } else {\n      this.messageLabel.string = \"❌ Not enough energy!\";\n      this.scheduleOnce(() => {\n        this.messageLabel.string = \"\";\n      }, 2);\n    }\n  },\n\n  onRecover() {\n    if (this.isGameOver()) return;\n\n    this.player.energy = Math.min(100, this.player.energy + 20);\n\n    this.updateUI();\n    this.scheduleOnce(this.enemyTurn, 1);\n  },\n\n  enemyTurn() {\n    if (this.isGameOver()) return;\n\n    const damage = Math.max(0, this.enemy.attack - this.player.defense);\n    this.player.health -= damage;\n\n    this.updateUI();\n    this.checkGameOver();\n  },\n\n  checkGameOver() {\n    if (this.player.health <= 0) {\n      this.messageLabel.string = \"💀 You Lose!\";\n      this.disableButtons();\n    } else if (this.enemy.health <= 0) {\n      this.messageLabel.string = \"🏆 You Win!\";\n      this.disableButtons();\n    }\n  },\n\n  isGameOver() {\n    return this.player.health <= 0 || this.enemy.health <= 0;\n  },\n\n  disableButtons() {\n    this.attackBtn.interactable = false;\n    this.skillBtn.interactable = false;\n    this.recoverBtn.interactable = false;\n  },\n});\n"]}